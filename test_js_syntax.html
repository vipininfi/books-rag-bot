<!DOCTYPE html>
<html>
<head>
    <title>JavaScript Syntax Test</title>
</head>
<body>
    <div id="test-container"></div>
    
    <script>
        // Test the problematic pattern that was causing the syntax error
        const testData = {
            book_id: 123,
            section_title: "Chapter 1: Introduction's Overview & \"Key Points\"",
            page_number: 42,
            text: "This is some sample text with 'quotes' and \"double quotes\""
        };
        
        // This would have caused the original error:
        // onclick="openPdfViewer(123, 'Chapter 1: Introduction's Overview & "Key Points"', 42, 'encoded text')"
        
        // Our new approach using data attributes:
        const container = document.getElementById('test-container');
        container.innerHTML = `
            <div class="result-item" 
                 data-book-id="${testData.book_id}" 
                 data-section-title="${testData.section_title.replace(/"/g, '&quot;')}" 
                 data-page-number="${testData.page_number}" 
                 data-text="${encodeURIComponent(testData.text)}"
                 style="cursor: pointer; padding: 10px; border: 1px solid #ccc; margin: 10px;">
                <h3>Test Result Item</h3>
                <p>Section: ${testData.section_title}</p>
                <p>Page: ${testData.page_number}</p>
                <button class="pdf-preview-btn">View PDF</button>
            </div>
        `;
        
        // Add event listener
        const resultItem = container.querySelector('.result-item');
        const button = container.querySelector('.pdf-preview-btn');
        
        function handleClick(element) {
            const bookId = parseInt(element.getAttribute('data-book-id'));
            const sectionTitle = element.getAttribute('data-section-title');
            const pageNumber = parseInt(element.getAttribute('data-page-number'));
            const encodedText = element.getAttribute('data-text');
            
            console.log('✅ Successfully extracted data:');
            console.log('  bookId:', bookId);
            console.log('  sectionTitle:', sectionTitle);
            console.log('  pageNumber:', pageNumber);
            console.log('  decodedText:', decodeURIComponent(encodedText));
            
            alert(`Success! Extracted data without syntax errors:\nBook ID: ${bookId}\nSection: ${sectionTitle}\nPage: ${pageNumber}`);
        }
        
        resultItem.addEventListener('click', (e) => {
            if (e.target.closest('.pdf-preview-btn')) return;
            handleClick(resultItem);
        });
        
        button.addEventListener('click', (e) => {
            e.stopPropagation();
            handleClick(resultItem);
        });
        
        console.log('✅ JavaScript syntax test completed successfully - no syntax errors!');
    </script>
</body>
</html>